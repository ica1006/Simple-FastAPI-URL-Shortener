<!DOCTYPE html>
<html>

<head>
    <title>URL Shortener</title>
</head>

<body>
    <h2>Simple FastAPI URL Shortener</h2>

    <input type="radio" value="Create" onclick="showCreateForm()" name="option" checked="checked"> Create
    <input type="radio" value="Create" onclick="showEditForm()" name="option"> Edit
    <input type="radio" value="Remove" onclick="showRemoveForm()" name="option"> Remove
    <br><br>

    <div id="create_form_div">
        <form id="create_form">
            <label for="domain">Domain:</label>
            <input type="text" name="domain"><br>
            <label for="query_id">Query parameter:</label>
            <input type="text" name="query_id"><br>
            <label for="url">Full url:</label>
            <input type="text" name="url"><br>
            <label for="admin_key">Admin key:</label>
            <input type="password" name="admin_key"><br>
            <input type="submit" value="Shrink">
        </form>
    </div>

    <div id="edit_form_div" style="display: none;">Edit</div>

    <div id="remove_form_div" style="display: none;">Remove</div>

    <script>
        function showCreateForm() {
            document.getElementById('create_form_div').style.display = 'block';
            document.getElementById('edit_form_div').style.display = 'none';
            document.getElementById('remove_form_div').style.display = 'none';
        }

        function showEditForm() {
            document.getElementById('create_form_div').style.display = 'none';
            document.getElementById('edit_form_div').style.display = 'block';
            document.getElementById('remove_form_div').style.display = 'none';
        }

        function showRemoveForm() {
            document.getElementById('create_form_div').style.display = 'none';
            document.getElementById('edit_form_div').style.display = 'none';
            document.getElementById('remove_form_div').style.display = 'block';
        }
    </script>

    <script>
        const form = document.getElementById('create_form');
        form.addEventListener('submit', function (event) {
            event.preventDefault();
            const data = {
                domain: form.domain.value,
                query_id: form.query_id.value,
                url: form.url.value,
                admin_key: form.admin_key.value
            };
            const json = JSON.stringify(data);
            const xhr = new XMLHttpRequest();
            xhr.open('POST', '/json');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.addEventListener('load', function () {
                if (xhr.status === 200) {
                    //const response = JSON.parse(xhr.responseText);
                    //alert(`Response: ${response}`);
                    alert('Success!')
                } else {
                    alert(`Error: ${xhr.status}`);
                }
            });
            xhr.send(json);
        });
    </script>

</body>

</html>